{"version":3,"sources":["js/gamma.js","js/classes/movingBall.js","js/classes/bullet.js","js/classes/spaceship.js","js/classes/comet.js","js/classes/Star.js","js/classes/spaceshipAI.js","js/menu/menu.js","script.js"],"names":["gamma1","ship","meteor1","meteor2","space","bullet","spaceshipSrc","enemy","gamma2","gamma","MovingBall","x","y","angle","r","speed","coordBox","mode","dx","dy","Math","sqrt","undefined","sin","cos","gone","minX","min","minY","maxX","max","maxY","checkModeConditions","MovingBallModes","bind","context","fillStyle","beginPath","arc","PI","fill","dispose","Bullet","Spaceship","skin","setMode","destination","bulletCoordBox","Image","src","c","setTransform","rotate","drawImage","distance","acos","stopped","Comet","shouldDisappear","craters","i","radius","random","offset","newCrater","findRes","find","oldCrater","push","forEach","crater","stroke","Star","backCount","SpaceshipAI","options","dataAI","applyAICalculations","optionsAI","prototype","move","call","setDestination","target","threat","a","b","sinAlpha","db","console","log","Menu","menu","document","querySelector","buttons","querySelectorAll","buttonListeners","Array","map","el","hide","show","classList","add","remove","index","action","toHide","addEventListener","removeEventListener","canvas","width","window","innerWidth","height","innerHeight","getContext","Game","initialState","spaceship","paused","over","score","comets","disposableComets","bullets","enemySpaceships","eventListeners","event","handler","shoot","setAIMode","e","code","halt","continueMovement","listener","starCount","stars","run","pause","continue","reset","drawBackground","comet","draw","font","fillText","shift","star","flicker","array","splice","length","tempComet","checkCollisions","checkBallsIntercept","ball1","ball2","cometIndex","cometArray","bulletIndex","bulletArray","end","fillRect","timestamp","update","requestAnimationFrame","mousePosition","onGameOver","game","unbindAction","bindAction","key"],"mappings":";;AQAA;;AACA;;ARDA,AQEA,IRFIA,MAAM,GAAG;AEAb,AEAA,ADAA,AGAA,ANCCC,EAAAA,IAAI,EAAE,SADM;AAEZC,AQCD,ERDCA,OAAO,EAAC,SAFI;AECb,AEAA,ADAA,AHECC,EAAAA,OAAO,EAAC,SAHI;AAIZC,AQAD,ERACA,KAAK,EAAC,SAJM;AGEb,AHGCC,EAAAA,MAAM,EAAG,oBALG;AAKmB,AQAhC;ARCCC,EAAAA,EKNYkE,AJAA9D,AMAAiF,UPMA,EAAE,4BANF;AKCZ,AJAA,ADMApF,AONC,EPMDA,KAAK,EAAG,OKNII,CAAZ,CEAe,CFAAC,CAAf,EAAiB,MJA2C;AIA3C,AJA2C,ADDhD,AOCG,CPDhB,OCCcD,CAA+C,QAA/CA,CAA+C;AAAA,ADS7D,IAAIH,ICTaI,CAA4C,CDSnD,GAAG,ICTIA,CAA4C;AIC3D,AJD2D,ADU5DX,AOTG,EPSHA,IAAI,ECVeY,ADUb,CKTAF,AEAEiF,CFAP,GAASjF,AJDkD,AMCzD,CFAF,EEAckF,CPQH,ICTOhF,GMCI,CAACiF,CNDoC,YMC7C,CAAuB,MAAvB,CAAZ;AFCF,AJF2D,ADW5D5F,AOTG,EPSHA,MCX0BY,CIEpBF,AJFsD,ADWrD,AOTCmF,CFAP,CLSO,EKTEnF,CAAT,EEAE,CNFuBE,CAAkC,CME1C,CPON,IOPW8E,IAAL,CAAUI,gBAAV,CAA2B,QAA3B,CAAf;AFCF,AJH2D,ADY5D7F,AOTG,EPSHA,MCZ6BY,CIGvBD,ALSC,AOTCmF,CFAP,CLSO,EKTE7E,AJHkD,IIG9C,CAAC0C,ELMH,CCTiB/C,GIGnB,AEAP,ENHyD,CMGlCmF,EFAA,CAAzB,EEA8B,CAACnB,SAAN,CAAgBoB,GAAhB,CAAoBlB,IAApB,CAAyB,KAAKc,OAA9B,EAAuC,UAAAK,EAAE;AFClE,AJJ2D,ADa5DhG,AOVmE,ACGpE,EROCA,EQPG2G,GROE,CCb+B/F,CII9ByD,ALSA,CQPG,GDH8D,ACG3DoB,GPNgD,CMGO,CFClE,ALKW,GKLM,AGEE,CHFnB,AGEoBC,EPNe9E,QAAwB,GOMhD,CAAuB,QAAvB,CAAb;AHDE,AJL2D,ADc5DX,AOXmE,ACIpE0G,EROC1G,GOX0B,CAAvB,ACIE,CAAC2G,CPPwC/F,ADcxC,EAAE,ECdoD,AOO7D,GAAgBgG,CREH,ICTkChG,COOzB,CAACiG,EPPsC,QOO7D;APP6D,ADe5D5G,AOXG,ACIJyG,EROCzG,IQPK,CAAC6G,CPR8CjG,CMI5CmF,CNJoD,GMIzD,ACIJ,CROa,EAAE,AOXC,ACIAY,EPRqC/F,EAAQ,CMIxCmF,CCIC,CAACe,EDJP,CAAUlF,IAAV,CAAe,GCI/B,CDJgB,CAAZ;ANJyD,ADShD,AOJT,ACIJ,CRAA,GQAIgB,CAAC,GPToD/B,AOSjD4F,CDJCT,CNLoD,GMKzD,CCIU,CAACe,CDJC,ENLyClG,EAAI,CMKxCmF,IAAL,ACIR,CDJkBpE,ACIA,IDJV,ACIR,CDJuB,ACI/B,EAEA,EDNgB,CAAZ;APeG,AOdJ,IPcQzB,KAAK,GAAGT,MAAZ;ACpBsD,IOYvDsH,qBHLAnF,SAAQ;AACZ,AGKD,UHLK0B,MAAM,AGKC1B,GHLE,IGKd,CHLmBrB,CAAlB,AGKmB;APZnB,AOYmB,SPZdH,CAAL,GAASA,CAAT;AIQA,AJPA,SAAKC,CIOD,AJPJ,GAASA,CAAT,CIOS6D,SAAL,GAAiB,AEDd,CFCP,EAAuB;AACtBZ,AJPD,AMME,ACIiB,QHHlBA,CJPI/C,CAAL,CMMO8E,ENNE9E,CIOF,AJPG,CMMR,CAAUyF,EFCD,AJPG,CAAd,CAH2D,CAI3D,EIMgB9B,EEDd,CAAoB+B,GAApB,CAAwB,EFCf,GAAiB,GAA3B,AEDC;AFED,AEDA,aFCK/B,SAAL;AACA,AJPD,AOSA,IFbWC,ILIR,COSE6C,MPTK1G,KAAP,COSH,GAAoB,CPTA,WAAjB,IAAgC,OAAOE,KAAP,KAAiB,WAApD,EAAgE;AAC/D,AOSAyG,MAAAA,KPTKtG,EAAL,EOSS,CPTCA,COSE,CPTA,IAAI,CAAhB;AIODiB,AJNC,AOSCxB,INdS+B,EGWXP,EGGExB,CAAC,EPTGQ,AOSA,EHHC,AJNN,CIMOiB,AGEK,EPRFjB,EAAE,IAAI,CIMjB,AJNC,GIMmB,CEDb,KFCP;AACAgB,AJNC,AMKC,ACIAvB,MHHFuB,EGGEvB,CAAC,EPTGG,AMKC6E,ACID,EHHC,CAACvD,AGCK,CDFX,CNLD,AMKWkE,GNLEnF,IIMd,AJNkB,CAACC,CMKjB,CAAoBoF,ENLR,CAAU,GMKtB,CAA2B,QAA3B,ENL2BvF,EAAL,EAAS,CAAT,aAAa,KAAKC,EAAlB,EAAsB,CAAtB,CAAV,CAAb;AIODgB,AJNC,AMKA,ACICnB,ILfS2B,EEYXR,EGGEnB,GPTIH,EIMC,CAACyB,EJNP,AOSS,CHHV,CAAY,AGGC,CPTChB,IIMGX,CAAjB,EAAmB,EJNlB,GIMuBC,CAAxB,EAA0BiD,MAA1B,EAAiC,CAAjC,EAAmC,IAAEzC,IAAI,CAACmB,EAA1C;AACAJ,AJNC,AKRD,AEgBcR,KPbd,CIWAQ,IGEcR,CPRP,EIMA,AGEU,CHFTa,CGEY,GHFpB,KCdYmC,OAAZ,EAAoB;ADepB,AJNC,AKTmB,AEgBChE,IJhBV8C,OHSL1C,COOeJ,CAAC,EAAG,CPPxB,AOOmB,GPPNI,KAAb,CADM,CAEN;ACTF,AMe6BH,YAAAA,CAAC,EAAG,SNf2B,OKahD8F,OAAOC,QAAqB;ALboB,ADU1D,AKXmB,ACcmB,ACEnB,QNfRhG,CAA+C,CKajCiG,CNHpB/F,AOKO,KPLZ,AMGsC,CLb3BF,CAA+C,CDU7CE,KAAb,+DMGgC,IAAM;ALboB,ADW1D,AEVF,AIaG,ACCkCiB,QNfrBlB,CAA4C,CMevBkB,CPJ9BZ,AMGC+E,ENHN,AOIsC,EAAG,CPJ/B,CCXIrF,CAA4C,GDW3CG,KAAL,AMGT,CJb+D,AIa1C2F,ENHCtF,CIKhB,EEFN,CNH0B,CAACG,EMGGoF,CNHR,CAAS9F,IMG/B,CNHsB,CAAvB;AIMD,AHjB2D,ADY1D,AEXgE,AGD/D,ACeA,ACAyCF,QNfzBE,EGiBfO,CJLGD,AMGC4E,CCAoCpF,CNfgB,ADY1D,AOG2C,CHErC,CAACmD,AGFuCiD,CPHpC,CAAC,CMGV,CAAaL,EFEZ,AHjBe7F,AMemC,CPHpCE,AOGqCiG,EDApD,EFEe,AHjB0C,AKerCH,CNHX,AOG+B,GPHjBzF,AKZjBuD,CDiBR,EAAuB,CJLM,CAACnD,EKZ5B,CLYuB,CAASX,GMGhC,CAAqC,CNHd,CAAxB,KMGC,EAA8C8F,MAA9C;AFGD,AHlB0D,AEA5D,AHaE,AKdmB,ACiBlB,ACD2D/F,QNfpCE,AIChBG,CJDkD,EKgBpD8E,CDjBa,AEgByCnF,CHGvD6D,AGHwD,EFdrCE,AEcwCoC,ENfxCjG,CAAkC,AKgBzD,CAAa4F,ECDwD,CHGtE,ACnBmB,AEgBoDS,CJfb,AEClDlG,CCeP,CFEgB,CEFIsF,CDjBF,CDmBnB,OEFC,CAA8BE,MAA9B,CAAqC,uBAArC;AFGD,AHnB0D,AEAA,ADCM,AGF7C,AEgBsB,QNfd1F,ACChBJ,AGAGiE,CHAkD,IDDN,CIDvC,GHERjE,AGAagE,CHAwC,GDDrC5D,GIDR,CAEL6D,CJD4C,KIDvC;ADqBpB,AHpB2D,ADe3D,AEdiE,AGC/D,ACeA,ACFW,QNfsB5D,ACCpBJ,CFcVa,AEd4D,CGC1DoD,ACeD+B,GNFN,GCf2D,ADe/C,AMEV,CJhBahG,CAAkD,AIgBlD,GNFf,GCfmCI,KIEjC,GJFyD,AIE9B,CAACC,IAAI,GAAG6D,SAAS,CAAC7D,IAAD,CAAZ,GAAqB6D,SAAS,CAAC,QAAD,CAAnC,EAA+C5C,IAA/C,+BAA3B;AJFyD,AEAA,AHgB3D,AEfiE,AGE/D,ACeE,ACNS,QNZgCjB,AEAjCN,ADCME,CCDyC,AHgBtDa,CKbEkD,EJHoD,CDgB3D,AEfiE,AIiBxDmB,GNFG/E,AKbV,CFHUL,CAA+C,CEG3CiE,CJH6B3D,AKkBzC,CJjBcJ,AIiBD6F,GLlB0C,ADgBvC,CAAC/E,AKbnB,CHF+D,AIiB7D,ENFQ,AMEYkF,CNFClG,CAAb,IAAkB,CAA9B,SMEI,CAAqC,OAArC,EAA8C,KAAK0F,IAAnD;ALlBuD,AEAA,AHiB3D,AEhBiE,AGF7C,ACoBjB,ACFF,QNjBkDnF,AEApCN,ADCUE,CCDkC,AHiBtDc,AEhB4D,CDDN,GDiB3D,GAAYZ,CGjBGJ,ADCUE,CDD0BI,AEAQ,ADCM,EDDN,IDiBvC,CAACS,GAAT,CAAaf,CAAb,IAAkB,CAA9B;ACjB2D,AEAA,AHkB3D,AEjBiE,AGGhE,ACgBA,ACFH,QNlByDO,AEArCN,ADCUE,CFiBvBc,CClBsD,GEAA,AHkB3D,AEjBiE,GFiBrDb,EClB2CG,EAAI,CEAzCN,ADCUE,GFiBR,CAACe,CGlBsC,ADCM,EFiBrD,CAAanB,CAAb,IAAkB,CAA9B;AGlB2D,AHmB3D,AElBiE,QCDxCG,ADCUE,CCDwB,AHmBtDe,IAAL,GAAYf,AElBqD,CCDxCF,CAAkC,MHmBvC,AElBeE,CFkBdc,GAAT,CAAalB,CAAb,EElBqD,EFkBnC,CAA9B;ACnB2D,AEAA,AHoB3D,AEnBiE,AKU7C,KAApB,CADmB,CAUnB,CJpB4BG,ADCiBE,CFmBxCe,GEnB4D,CCDN,ODCdf,CCDjBF,GDCqC,ECDN,EHoB3D,GAA2B,CAACE,IAAI,GAAGgB,eAAe,CAAChB,IAAD,CAAlB,GAA2BgB,eAAe,CAAC,SAAD,CAA/C,EAA4DC,IAA5D,CAAiE,IAAjE,CAA3B;AGpB2D,AHqB3D,AEpBiE,QCD9BlB,ADCgBE,EAAc,MCDN,EDCRA,EAAc,ICD9BF,QAAwB,CGsB9C0F,OAAO;ALtBuC,AEAA,ADCM,AIsB/D,ACFF,QJrB6CzF,ADCUE,CKoBlDsG,CLpB4D,CIsB1D1B,CHvBoD,GIqB3D,GLpBuD5E,AIsBrD,ACFY,CDECuF,CHvB8BzF,ADCoB,EKoBjE,EJrB2D,AGuBzD,EAAoB6F,CDjBhB,EJLA,gBKsBJ,CAAwC,OAAxC,EAAiD,KAAKb,eAAL,CAAqBS,KAArB,CAAjD;ALtBK/F,AEDoD,ADCM,AGM/D,ACiBA,ACFF,MNrBOA,CAAC,CED2CO,ADCQ0B,CDApDjC,AMqBF+G,CNrBC,AEDqD,CEOpD7C,ACiBAkB,CJvB0D,CKqBjE,GAAY,EJtBuC7E,AGwBjD,CAAawF,CHxB4C,ADCA9D,CKqB3D,GLrBiE,AIuB/D,EAAoBkE,IDjBpB,eCiBA,CAAwC,OAAxC,EAAiD,KAAKT,IAAtD;ALvBQzF,AEDiD,AGyBzD,ACFF,MNtBUA,CAAC,CED4CO,CFC7CP,AMsBL+G,CNtBC,AEDqD,CGyBpD5B,GCFP,GAAa,CJvB0C5E,AGyBrD,ACFF,CDEeuF,CHzB4C,IGyBzD,EAAoBH,SAApB,CAA8BC,GAA9B,CAAkC,uBAAlC;ALxBW3F,ACAoD,AGO/D8B,ACkBA,ACFF,MNvBa9B,GMuBRsB,ENvBa,AKyBX8D,ELzBMpF,GMuBb,ENvBM,CMuBSsB,MPDXA,CMGF,ACFF,CFhBY4C,ACkBW2B,AChBJ,CAenB,IDCE,ENHU,EKfV,ACkB8B,CDlBV1B,GCkBpB,CDlBA,CAAyBC,IAAzB,CAA8B,IAA9B;AJPkBnE,AEDuC,AHwB3DqB,AKfC,ACkBA,ML1BmBrB,ADuBpBqB,CCvBqB,EAADrB,CAAd,GDuBC,CAACsB,SAAR,GAAoB,MAApB;ACvBuBrB,ADwBvBoB,AEvBA,AKwBA,MNzBuBpB,ADwBvBoB,GOCKqF,ENzBuB,EAALzG,ADwBhB,CAACsB,ICxBF,AMyBN,GAAiB,EPDjB,EOCqBM,KLxBf,eKwBW,CAAc;ANzBD3B,AEA9B,AHyBAmB,AExBOxB,AKyBNA,MN1B6BK,ADyB9BmB,AExBOxB,AKyBNA,CLzBO,AKyBN,ELzBKA,AKyBF,CLzBC,GFwBC,CCzB+B,ADyB9B2B,AOCEiF,EN1BoBvG,CDyB9B,CAAY,KAAKL,CCzBX,ADyBN,EAAmB,AOCd,CAAkB6G,GJ1BjB,CHyBkB5G,CAAxB,EAA0B,EOCrB,CAA4BD,CADF,CPAAG,CAA/B,EAAiC,CAAjC,EAAmC,IAAEM,IAAI,CAACmB,EAA1C;ACzBwCtB,AEAjCN,AH0BPwB,AEzBUvB,AK0BTA,MN3BuCK,AEAjCN,AH0BPwB,AEzBUvB,AK0BTA,CJ3BO,ADCG,AK0BT,EJ3BKD,ADCGC,AK0BL,CN3BuC,AEAtC,ADCA,EDDkCK,CD0BjC,CAACuB,AOCE+E,EN3BJ,ED0BN,QOCK,CAAkBC,GFjBbvG,MAAM2D,AEiBX,CAA4BhE,CAFF,MFfR;AJVuBM,AEApCN,AH2BV,AE1BaC,AGUX,AEiBDG,MN5B6CE,AEApCN,ADCGC,AK2BZG,CJ5BU,CFAqC,CEAtCJ,CFAoCM,AEAxC,CDCY,AGUX2D,CJXD,CCCOhE,CK2BJ,EAAG,EL3BN,GK2BW0G,SFjBf,GAA2BzC,AEiBjB,CAAkB0C,QFjBQ,CAACvG,AEiB3B,CAA4BD,GFjBF,CAAT,CAAgBkB,IAAhB,CAAqB,IAArB,CAA3B;AJXgDf,AEArCN,ADCOC,AGWlB,AEa6B,KAAd,CNzBiCK,AEArCN,ADCOC,AKwBpB,CLxBqB,CDD+B,CCChCA,CDD8BK,ACC5C,CCDY,AEYXyD,EFZM/D,IEYX,CFZI,EEYU+D,MAAd;AJZI,AEAc9D,ADCGC,AGYtB,AEiBD,KN/B2D,CECvCD,ADCGC,CCDF,EAADD,AI8Bf8G,CJ9BC,CDCsB,EAAL7G,EK6BvB,GL7BM,AK6BQ,EAAd;AN7BA,AEDuBA,ADCOC,AK8B9B,MJ/BuBD,ADCOC,GK8BzB6G,EJ/BuB,EAAL9G,CDCe,EAARC,ECDxB,MDCA,CK8BN,EPFK,COEmB,EAAxB;AJ/B8BA,AH8B9B,AE7BwCC,AK+BxC,MJhC8BD,ADCUC,GK+BnC6G,CL/BuC,CF6BvCnH,CAAL,AE7BwCM,ECDF,EAARD,AH8BpB,AE7BJ,AK+BN,GAAe,EPFAE,AOEf,EPFA,CG9BM;AAAkCD,AH+BxC,AE9B8CC,AKgC9C,MJjCwCD,ADCMC,EAAE,CKgC3C6G,CJjCuC,ADCE7G,CF8BzCN,CG/BmCK,AH+BxC,AE9BM,ICDA,AH+BI,KAAKE,EAAf,COEA,GAAuB,EAAvB,CAxBmB,CAyBnB;AJlC8CD,AHgC9C,AE/BkDC,EGJnBwB,IFGezB,ADCIC,ECDF,ADCI,ECDND,ADCIC,CF+B7Ca,CGhCC,kBHgCN;AGhCkDb,ADC5C,AKkCN,KLlCA,CCDkDA,EAAE,CImC/C6G,CJnC6C7G,aImClD,ENhCIgB,CMgCkB,CACrB,ONjCW;AACZA,AEJM,AHiCN,AE/BA,AKmCEgD,KJrCF,CFIAhD,AMiCEgD,IPJE,AE/BCrE,CAAL,CKmCQ,CNjCD,CAACsB,ACFCtB,AKmCCiG,CPJDpG,AE/BC,CF+BN,GAAS,AE/BC,CKkCb,CLlCD,EDEA,CD6BkBe,EC7BEjB,ED6BhB,IAAsB,KAAKE,CAAL,CC7BAN,ED6BS,IC7BnC,CD6BwCwB,IAApC,IAA4C,KAAKjB,CAAL,GAAS,KAAKgB,IAA1D,IAAkE,KAAKhB,CAAL,GAAS,KAAKmB,IAApF,EAAyF;AC5BzFI,AEJA,AHiCC,AE/BD,AGaF,AEsBI8F,IFtBEnD,EJXJ3C,AMiCE8F,IJrCGvE,ADEA3C,CKmCE,ENjCA,AD6BD0B,AKlBO,AEsBJ,CNjCDJ,CCFR,CGagB,EHbHtB,EF+BZ,AOEA,GN/BD,ACFkB,ECFlB,EDEsB,CCFC,CDEvB,ICFA,CAF2D,CAG3D;AFIAoB,AD6BC,AE/BD,AGcA,AEqBE+F,MNjCF/F,AMiCE+F,ILnCGhH,CGcK,CHdV,CDEO,AMiCE,CNjCDoB,CCFEpB,AKmCC,ENjCX,ACFY,CDEA,GCFI,CAAhB,CDEiBP,CAAjB,EAAmB,EIYE,CAEpB,CAJe,CJVQC,CAAxB,AMiCYqH,ENjCc,GMiCf,ENjCoBnH,AMiCT,CNjCtB,EAAiC,CAAjC,EAAmC,IAAEM,IAAI,CAACmB,EAA1C;AACAJ,AEJE,AHiCF,AE/BA,AGiBA,AEkBG,MNjCHA,IEJOwB,ADEFxC,EAAL,AGiBY,AEkBHd,CNjCF,CAACmC,CCFEtB,ECFR,ADEU,CDEZ,AMiCe,EJrCE,CDED,AKmCE,CJrChB,ADEF,IKmCsB,CAACsG,GFlBD,MEkBJ,CAAeW,KAAf,EAAf;ANhCH,AIeE,SAAKjD,cAAL,CAAoB,KAAKN,MAAL,CAAYO,MAAZ,CAAmBxE,CAAvC,EAA0C,KAAKiE,MAAL,CAAYO,MAAZ,CAAmBvE,CAA7D;AFxByD,ADO3D,AGkBC,AEiBE,GFzBa,KEyBb,ELnCEiC,GKmCE,CAACiF,GLnCR,CAAa7G,GKmCV,CLnCc,AKmCDmD,ILnCK,AKmClB,CAAkB/D,IJrCVuD,CALgD,CDO3D,AKmCG;AJpCC,AEqBJ,UFrBQC,CEqBE,KFrBI,GAAG,MAAK/C,CAAL,EEqBG,CFrBI,CHiChB,CGjCS,GAAYM,IAAI,CAAC0C,MAAL,KAAgB,MAAKhD,CAArB,GAAyB,CAAlD;AACA,AHiCJ,AEhCA,AGoBE,AEeC,QFfKsE,AEeL,EJpCKrB,ADCHjB,CFgCArB,EOGE,CFfO,AEeNsG,CPHR,CGjCc,CEqBG,CLYL,CGjCKlE,EDCjB,CFgCA,AKZsBe,EHpBH,CCDI,GAAC,AEqBP,CFrBA,AEqBYQ,AEe1B,CAAqBf,EJpCIjD,GEqB1B,CFrB8B,CAAC0C,AIoC9B,CAA6B,KJpCJ,KIoCI7D,CJpCa,GIoCT,EAAI,CJpCUa,CAAL,GAAS,IAAE+C,MAAF,GAAS,CAAnC,CAAxB;AACA,AHiCJ,AEjCoBlD,AGqBlB,AEeEV,EN7CsBS,ICSNC,CAAC,CGqBb0E,CHrBgB,AGqBf,CFrBDxE,AIoCJZ,EFfQmF,EEeJ,CJpCK,ADAgBzE,AKoCpByH,CLpCU,ECAHhH,AEqBE,CAACD,EAAP,CFrBQ,CAAC2C,CEqBGsB,AEepB,CAAe,IJpCH,CEqBc,CAAClE,CEe3B,CFfF,CFrB8BE,AIoCJ,IJpCQ,CAACmB,EAArB,GAA0B,CAAtC;AACA,ADD4B3B,AGsB9B,AEc2BwE,MLpCGxE,CAAC,CGsB3B0E,CHtB8B,AGsB7B,CFrBCtB,EEqBEoB,AEcmBA,GLpCYxE,GGsBzB,AEcmB,CJnClB,AEqBAA,CAAP,AEc4BP,EJnClB,CEqBC+E,MAAM,CAACzE,CAAP,GAAW0E,CAA9B;AFpBI1E,ADFa,AGuBjB,AEa0B,KLpC5B,GCEMA,AEqBE4E,CFrBD,EAAExB,AIkCL,KFbY,CFrBD,EEqBIqB,CFrBDhE,IAAI,CAACI,AEqBE,CAACN,EFrBR,AEqBC,CFrBQL,EEqBIO,GFrBb,CADE,AEsBe,CAACC,IAAL,CAAU,SAAA+D,MAAM,CAAClE,EAAP,EAAW,CAAX,aAAekE,MAAM,CAACjE,EAAtB,EAA0B,CAA1B,CAAV,CAA7B;AFpBIP,ADFN,AGuBE,AEaE,QJlCEA,AEqBE4E,CFrBD,AIgCJ,CLlCEzC,AGuBK,CFrBDgB,EEqBI,CAACqB,GFrBC,GAAGhE,AEqBE,CAACN,CAAP,EFrBQ,ADFtB,CCEuBS,AEqBE,EHvBHP,CCEJ,AHgCXC,CGhCoBJ,CEqBGC,CAAjB,GFrBK,AHgCN,CGlCQ,ADApB,AGuBmCyE,QAAjC;AFpBIzE,AHgCN,AElCA,AKoCG,QJlCGA,CAAC,CDFF8B,CCEIiB,AHgCJ7B,GElCL,GAAY,IAAIgB,KAAJ,EAAZ,EFkCA,GAA2Bf,eAAe,CAAChB,IAAD,CAAf,CAAsBiB,IAAtB,CAA2B,IAA3B,CAA3B;AGnCoB,AHoCpB,AElCA,AGsBE,AEID,KADqB,EJ3BlB,AIsCA,CFdG,EHtBFU,GGsBOhC,CHtBZ,AGsBO,CHtBGqC,EGsBMoC,CHtBhB,AGsBiB,GHtBDzC,AGsBI,IHtBA,CGsBKjC,CAAT,EHtBQF,CGsBK6E,CAAb,GAAiBE,EAA3B,IAAmC,EHtBXlF,GGsBgBM,CAAL,GAASyE,CAAC,GAAG,CHtBtD,IGsB2D1E,CAAT,GAAa2E,CAAb,GAAiBE,EAAjE,EAAqE;AHhCN,AGiC7DC,AEcFN,MFdEM,AEcFN,MAAM,CFdG,CAACO,AEcFqB,GFdN,CAAY,EEaZ,YFbA;AFpBH,ADFD,AGuBI,AEcFkB,MAAAA,IJnCGhE,AEqBKf,CAAC,AEcJ,EAAE,CFdK,GFrBF,EEqBOtC,CFrBJ,AEqBD,GAAS,CEYnB,EJjCgB+C,EEqBQhD,CAAL,GAAS0E,CFrBjB,AEqBX,CFrBwBnB,IAAb,CAAkB,UAAAC,SAAS;AAAA,AEsBtCmB,AEcF4C,MFdE5C,AEcF4C,CFdG,IAAI,EEcA,EJpCqC9G,AIoClC,CFdER,CAAL,EFtByC,CAACS,AEsBjCgE,CAAC,GFtB2B,AEsBxB,CFtBkC,AIoCnCgD,CAAT,EAAW,CFdI1H,CAAT,GAAa2E,CFtB0BnB,AEsBhD,GAA0B,CAACqB,EAA3B,GFtByD,AEsBzBA,CFtB0B7E,CAAV,AEsBrD,GFtBmEqD,SAAS,CAACrD,CAAzB,EAA6B,CAA7B,aAAgCwD,SAAS,CAACvD,CAAV,GAAcoD,SAAS,CAACpD,CAAxD,EAA4D,CAA5D,CAAV,IAA2EuD,SAAS,CAACrD,CAAV,GAAckD,SAAS,CAAClD,CAAvG;AAAA,AEuBtC,AEcD,OJrCY,CAAd,EEuBSH,CAAC,GAAG,CAACuC,AEcL,CFdM,GAAGoC,CAAL,AEcCJ,IFdSG,CAAV,IAAe,KEcnB,CAAoBgD,CAAC,CAAC1H,CFdH0E,AEcnB,CFdoB,CEcKgD,CFdH,AEcI,CFdN,AEcOzH,CFdR,AEcnB,CAAP,EFdiC,CAAtB,CAAV;AACA,AEcD,OAFS,CAERsB,EFdMtB,CAAC,CEYC,CAEH,CFdKyE,CAAC,GAAG1E,AEcJ6G,CFdA,GAAQlC,CAAlB,IEYQ;AJnCR,AEwBA,AEQA,KAXkB,EAiBlB,GJtCI,CEwBCJ,MFxBMjB,OAAP,CDDJf,AGyBA,CAAoBvC,CAApB,CHzBE,CCCqB,AEwBAC,CAAvB,UFxBA,EAAmC;AACjC,AHgCR,AEjCEsC,AGyBG,AEcDiC,IPNElD,EEjCJiB,AKuCEiC,CLvCD,CAAChC,IKuCM,EJtCGQ,AIsCDkC,KPNS,CEjCnB,CCCM,ADDS,CCCIzB,AHgCG,AEjCtB,AKsCI,ELtCc,CAAlB,CCCM,CAAkBJ,ADDH,CAArB,EAAwB,CAAxB,EAA2B,GCCrB,EDD0BrD,CAAhC,EAAmC,KAAKC,CAAxC,EADM,CACsC;ACEvC,AHgCN,AKRE,AEcCqH,MAAAA,KAAK,EPNI,AOMF,SAFL,UPJiB;AGjDsC,AHkD3D,AElCE/E,AGCc,AEuCdgF,CFvCJ,KHDIhF,AKwCAgF,CLxCC,CFkCC,AElCA9E,KFkCKzC,AOMA,CPNL,AElCF,CAAS,AKwCA,EPNE,GElCGE,EFkCEa,GElChB,CFkCE,IAAsB,EOMf2G,CAAC,EPNmB1H,AOMf,CPNU,GAAS,KAAKkB,IAApC,IAA4C,KAAKjB,CAAL,GAAS,KAAKgB,IAA1D,IAAkE,KAAKhB,CAAL,GAAS,KAAKmB,IAApF,EAAyF;AACxF,AElCDmB,AKwCG,MLxCHA,CAAC,CAACG,GFkCIZ,COMC4F,CAAC,CAACC,GLxCT,CFkCC,AElCW,AKwCL,KLxCU1F,AKwCC,ILxClB,EAAuB,CAAC,AKwCrB,EAAuB,GLxCG9B,CAA7B,EAAgC,CAAC,KAAKA,CAAtC,EAAyC,IAAE,KAAKA,CAAhD,EAAmD,IAAE,KAAKA,CAA1D;ACZE,AH+CD,AElCDoC,AKwCI,MLxCJA,CAAC,CAACC,CCbK,CIqDH,GJrDOS,CAAC,CIqDJ,CAAC4D,CJrDM,CAAb,EAAgB5D,ADalB,CCbmB,ADaJ,CAAf,ECbsB,ADaJ,CCbhB,ADaF,AKwCI,CAAe2E,CJrDM3E,ADaJ,CCbK,ADa1B,ECbE,ADasB,AKwCpB,CLxCJ,CCb6B,CDaF,CAA3B,EAA8B,CAA9B;ACb6B,AHgD7B,AElCA,AKwCI,GPXkB,SG3CXA,CAAkB;AAa1B,AHqCJ,AOKI,YPLO,kBAAU;AACpB,AOHI,KAjBkB,EAyBlB,CPLA,KAAKjD,CAAL,GAAS,KAAKG,CAAd,GAAkB,KAAKY,IAAvB,IAA+B,KAAKf,CAAL,GAAS,KAAKG,CAAd,GAAkB,KAAKe,IAA1D,EAA+D;AGxDJ,AHyD1D,AOKCsD,MAAAA,KPLIjE,COKE,CPLP,COKS2E,GPLE,CAAC,CAAZ,GOIG,aLxCUlF,GAAGC,GAAE;ACFnB,AHuCC,AEpCD,AKyCEqH,MAAAA,KPLItH,AEpCDmC,AKyCE,CPLN,COKQ,GPLE,IOGP,CPHY5B,CEpChB,CFoCC,EEpCkB;AFqClB,AErCmBP,AK0ClBuH,MAAAA,EL1CkBvH,CAAC,EAADA,CAAD,CK0CV,EAAE,iBAAA0H,CAAC,EAAI;AL1COzH,AK2CpB,QL3CoBA,CAAC,EAADA,CK2ChByH,CAAC,CAACC,IAAF,KAAW,OAAf,EAAuB;APL1B,AEtCmB,AK4Cf,OL5CJ,CFsCI,EOMA,GPNK1H,CAAL,COMI,CAAC4G,CPNI,KAAK1G,CAAd,EOMA,CPNkB,AOMH0H,KPNQ5G,IAAvB,IAA+B,GOM/B,EPNoChB,CAAL,GAAS,KAAKE,CAAd,GAAkB,KAAKiB,IAA1D,EAA+D;AAC9D,AEtCD,AK4CI,UL5CAuB,CFsCEnC,EAAL,IAAW,CAAC,AEtCD,CFsCX,EEtCcC,ICFX8B,ADEe,CAAC7B,ECFd,EDES,CAAU,SAACV,CAAC,GAAG,KAAKA,CAAV,EAAc,CAAd,aAAmBC,CAAC,GAAG,KAAKA,CAA5B,EAAgC,CAAhC,CAAV,CAAf;ACFM,AHyCL,AEtCD,AK4CG,WPNGA,AEtCDM,CFsCJ,CEtCD,GFsCW,AEtCD,KFsCMC,AEtCDJ,EFsCd,GEtCS,IAAcJ,CAAC,GAAG,KAAKA,CAAvB,IAA4B2C,QAAtC;AFuCC,AEtCD,AKoCI,KAzBkB,CAAtB,KLXKnC,EAAL,GAAU,KAAKJ,KAAL,IAAcH,CAAC,GAAG,KAAKA,CAAvB,IAA4B0C,QAAtC;ACHAJ,AH0CA,AEtCA,AK6CA,GPvBsB,GG1BtBA,CAAC,CAACd,CIiDG4F,EL7CAnH,KAAL,CCJA,EDIa,CCJCJ,GIiDd,CL7CkBS,AK6CEmD,EL7CP,GAAU,CAAV,CK6Cb,CAA6B,CJjDTnE,ADIOkB,IAAI,CAACmC,ECJhC,EDI2B,AK6CEkF,CL7CQ,CAAC,KAAKtH,CK6CN,CL7CA,CK6CI,EL7CK,KAAKJ,KAAxB,CAAd,GAA+C,CAACK,IAAI,CAACmC,IAAL,CAAU,CAAC,KAAKpC,EAAN,GAAS,KAAKJ,KAAxB,CAA7D;ACHA,AH2CD,AEvCC,AK6CC0H,MAAAA,IJjDG,CH2CK,GOMA,CJjDA/E,AIiDCyB,MAAT,CAAgB0B,MPNE,EG3CnB,EACC3D,CAAC,CAACd,IIgDF,CAAiCqG,IJhDjC,GAAchI,CIgD2B,CAACwH,KAA1C,EAAiDQ,IJhD7BtI,IIgDqC,CAAC+H,EJhD1D,KIgDA;AJ/CDhF,AH0CA,AOMC,KAFD,CJ9CAA,CAAC,AIfkB,CJejBb,AH0CC,AOQH,KPRQ1B,CAAL,GG1CH,AH0CY,KAAKe,IAAjB,EAAsB;AGzCtBwB,AH0CC,MG1CDA,CAAC,CAACZ,GAAF,AH0CM3B,CG1CA,AH0CL,GAAS,EG1CCA,CAAX,EAAa,AH0CEe,IAAd,CG1CiBd,CAAlB,EAAoB,KAAKE,CAAzB,EAA2B,CAA3B,EAA6B,IAAEM,IAAI,CAACmB,EAApC;AACEW,AH0CD,AOOD,MJjDEA,CAAC,CAACV,CIiDCkG,GJjDH,MIiDF,GAAiB,EAAjB,IL/CK;ACDH,ADEF,AK+CA,SAAKC,EJjDEhF,ADEFH,GK+CL,GAAa,CJjDX,ADEF,CCFea,AIiDf,EL/Ce,IAAf,CCFE,CAAqB,UAAAC,MAAM,EAAI;AAC7BpB,AHyCJ,AEvCA,QCFIA,AHyCD,CGzCE,CAACb,GHyCE1B,CAAL,GAAS,EGzCR,GHyCakB,IAAjB,EAAsB;AGxClBqB,AHyCH,AOOD,QJhDIA,CAAC,AIgDD,CJhDEZ,CHyCA3B,CAAL,CGzCG,AIgDIiD,CJhDE,AIgDD,CPPC,EOOE,CAAZ,EJhDc,AHyCC/B,AOOA+B,CJhDAjD,AIgDC,CJhDN,EHyCT,AOOkB,CJhDA2D,IIgDKoE,EJhDC,CAAC/H,CAAtB,EAAyB,GIgD7B,EAAmCiD,CJhDF,AIgDG,CJhDFhD,CAAL,AIgD7B,EAAuC,CJhDD0D,MAAM,CAAC1D,CAAzC,EAA4C0D,MAAM,CAACxD,CAAnD,EAAsD,CAAtD,EAAyD,IAAIM,IAAI,CAACmB,EAAlE;AACAW,AHyCH,AOOA,QJhDGA,CAAC,CAACqB,CIgDAoE,KJhDF,AIgDH,CAAWvE,IAAX,C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","file":"script.75da7f30.js","sourceRoot":"..","sourcesContent":["let gamma1 = {\r\n\tship: '#E15A97',\r\n\tmeteor1:'#EEABC4',\r\n\tmeteor2:'#F9E900',\r\n\tspace:'#1a1122',\r\n\tbullet:  'hsl(40, 100%, 57%)', //'#2f2',\r\n\tspaceshipSrc: './ships/spaceship_teal.gif',\r\n\tenemy : './ships/spaceship_red.gif'\r\n}\r\n\r\nlet gamma2 = {\r\n\tship: '#E15A97',\r\n\tmeteor1:'#4B2840',\r\n\tmeteor2:'#F9E900',\r\n\tspace:'#EEABC4',\r\n\tbullet: '#000',\r\n\tspaceshipSrc: './ships/spaceship.gif'\r\n}\r\n\r\n\r\n\r\nexport let gamma = gamma1;","export class MovingBall{\r\n\tconstructor({x, y, angle, r, speed, coordBox, mode, dx, dy}){\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.r = r || 5;\r\n\t\t//angle and speed have priority over dx and dy\r\n\t\tif(typeof angle === 'undefined' || typeof speed === 'undefined'){\r\n\t\t\tthis.dx = dx || 1;\r\n\t\t\tthis.dy = dy || 1;\r\n\t\t\tthis.speed = Math.sqrt(this.dx**2 + this.dy**2);\r\n\t\t\tthis.angle = undefined;\r\n\t\t} else {\r\n\t\t\tthis.speed = speed;\r\n\t\t\t//should we calculate the angle change in case of bounce?\r\n\t\t\tthis.angle = angle;\r\n\t\t\tthis.dx = this.speed * Math.sin(angle);\r\n\t\t\tthis.dy = -this.speed * Math.cos(angle);\r\n\t\t}\r\n\t\t\r\n\t\tthis.gone = false;\r\n\t\tthis.minX = coordBox.min.x || 0;\r\n\t\tthis.minY = coordBox.min.y || 0;\r\n\t\tthis.maxX = coordBox.max.x || 0;\r\n\t\tthis.maxY = coordBox.max.y || 0;\r\n\t\tthis.checkModeConditions = (mode ? MovingBallModes[mode] : MovingBallModes['flyAway']).bind(this);\r\n\t}\r\n\t\r\n\tdraw(context){\r\n\t\tcontext.fillStyle = '#888';\r\n\t\tcontext.beginPath();\r\n\t\tcontext.arc(this.x,this.y,this.r,0,2*Math.PI);\r\n\t\tcontext.fill();\r\n\t}\r\n\r\n\tmove(){\r\n\t\tthis.x += this.dx;\r\n\t\tthis.y += this.dy;\r\n\t\tthis.checkModeConditions();\r\n\t\tif (this.x < this.minX || this.x > this.maxX || this.y < this.minY || this.y > this.maxY){\r\n\t\t\tthis.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\tdispose(){\r\n\t\tthis.gone = true;\r\n\t}\r\n\r\n\tsetMode(mode){\r\n\t\tthis.checkModeConditions = MovingBallModes[mode].bind(this);\r\n\t}\r\n}\r\n\r\nconst MovingBallModes = {\r\n\t'flyAway' : function(){\r\n\t\tif (this.x < this.minX || this.x > this.maxX || this.y < this.minY || this.y > this.maxY){\r\n\t\t\tthis.dispose();\r\n\t\t}\r\n\t},\r\n\r\n\t'bounce' : function(){\r\n\t\tif (this.x - this.r < this.minX || this.x + this.r > this.maxX){\r\n\t\t\tthis.dx *= -1;\r\n\t\t\tthis.x += this.dx;\r\n\t\t}\r\n\t\tif (this.y - this.r < this.minY || this.y + this.r > this.maxY){\r\n\t\t\tthis.dy *= -1;\r\n\t\t\tthis.y += this.dy;\r\n\t\t}\r\n\t},\r\n\r\n\t'stall' : function(){\r\n\t\tif(this.x < this.minX){\r\n\t\t\tthis.x = this.minX;\r\n\t\t}\r\n\t\tif(this.x > this.maxX){\r\n\t\t\tthis.x = this.maxX;\r\n\t\t}\r\n\t\tif(this.y < this.minY){\r\n\t\t\tthis.y = this.minY;\r\n\t\t}\r\n\t\tif(this.y > this.maxY){\r\n\t\t\tthis.y = this.maxY;\r\n\t\t}\r\n\t}\r\n}\r\n","import {gamma} from '../gamma.js';\r\nimport {MovingBall} from './movingBall.js';\r\n\r\nexport class Bullet extends MovingBall{\r\n\tconstructor({x, y, angle, r, speed, coordBox, mode, dx, dy}){\r\n\t\tsuper({x, y, angle, r, speed, coordBox, mode, dx, dy});\r\n\t}\r\n\t\r\n\tdraw(context){\r\n\t\tcontext.fillStyle = gamma.bullet;\r\n\t\tcontext.beginPath();\r\n\t\tcontext.arc(this.x,this.y,this.r,0,2*Math.PI);\r\n\t\tcontext.fill();\r\n\t}\r\n}\r\n","import {Bullet} from './bullet.js';\r\nimport {gamma} from '../gamma.js';\r\nimport { MovingBall } from './movingBall.js';\r\n\r\nexport class Spaceship extends MovingBall{\r\n\tconstructor({x, y, angle, r, speed, coordBox, mode, dx, dy, skin}){\r\n\t\tsuper({x, y, angle, r, speed, coordBox, mode, dx, dy});\r\n\t\tthis.r = r || 20;\r\n\t\tthis.speed = speed || 10;\r\n\t\tthis.dx = dx || 0;\r\n\t\tthis.dy = dx || 0;\r\n\t\tthis.setMode(mode || 'stall');\r\n\t\tthis.destination = {x : this.x, y : this.y};\r\n\t\tthis.bulletCoordBox = coordBox;\r\n\t\tthis.skin = new Image();\r\n\t\tthis.skin.src = skin || gamma.spaceshipSrc;\r\n\t}\r\n\r\n\tdraw(c){\r\n\t\tc.setTransform(1, 0, 0, 1, this.x, this.y); // sets scales and origin\r\n    c.rotate(this.angle);\r\n\t\tc.drawImage(this.skin, -this.r, -this.r, 2*this.r, 2*this.r);\r\n\t\tc.setTransform(1, 0, 0, 1, 0, 0);\r\n\t}\r\n\r\n\tsetDestination(x, y){\r\n\t\tthis.destination = {x, y};\r\n\t\tlet distance = Math.sqrt((x - this.x)**2 + (y - this.y)**2);\r\n\t\tthis.dx = this.speed * (x - this.x) / distance;\r\n\t\tthis.dy = this.speed * (y - this.y) / distance;\r\n\t\tthis.angle = this.dx > 0 ? Math.acos(-this.dy/this.speed) : -Math.acos(-this.dy/this.speed);\r\n\t}\r\n\r\n\thalt(){\r\n\t\tthis.stopped = true;\r\n\t}\r\n\r\n\tcontinueMovement(){\r\n\t\tthis.stopped = false;\r\n\t}\r\n\r\n\tmove(){\r\n\t\tif (this.stopped){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Math.sqrt((this.destination.x - this.x)**2 + (this.destination.y - this.y)**2) < this.r/2 + this.speed){\r\n\t\t\tthis.x = this.destination.x - this.r*this.dx/(2*this.speed);\r\n\t\t\tthis.y = this.destination.y - this.r*this.dy/(2*this.speed);\r\n\t\t} else {\r\n\t\t\tthis.x += this.dx;\r\n\t\t\tthis.y += this.dy;\r\n\t\t}\r\n\t}\r\n\r\n\tshoot(){\r\n\t\treturn new Bullet({\r\n\t\t\tx : this.x + this.dx * this.r / this.speed,\r\n\t\t\ty : this.y + this.dy * this.r / this.speed,\r\n\t\t\tangle : this.angle,\r\n\t\t\tspeed : 25,\r\n\t\t\tcoordBox : this.bulletCoordBox\r\n\t\t});\r\n\t}\r\n}","import {gamma} from '../gamma.js';\r\nimport {MovingBall} from './movingBall.js';\r\n\r\nexport class Comet extends MovingBall{\r\n\tconstructor({x, y, angle, r, speed, coordBox, mode, dx, dy}){\r\n\t\tsuper({x, y, angle, r, speed, coordBox, mode, dx, dy});\r\n\t\tthis.shouldDisappear = false;\r\n\t\t//Create craters\r\n    this.craters = [];\r\n    for (let i = 0; i < 3; i++){\r\n      let radius = this.r/10 + Math.random() * this.r / 3;\r\n      let offset = radius/2 + Math.random() * (this.r - 3*radius/2);\r\n      let angle = Math.random() * Math.PI * 2;\r\n      let newCrater = {\r\n        x: offset * Math.cos(angle),\r\n        y: offset * Math.sin(angle),\r\n        r: radius\r\n\t\t\t};\r\n\t\t\tlet findRes = this.craters.find(oldCrater => Math.sqrt((oldCrater.x - newCrater.x)**2+(oldCrater.y - newCrater.y)**2) < oldCrater.r + newCrater.r);\r\n      if (typeof findRes === 'undefined'){\r\n        this.craters.push(newCrater);\r\n      }\r\n    }\r\n\t}\r\n\t\r\n\tdraw(c){\r\n\t\tc.fillStyle = gamma.meteor1;\r\n\t\tif (this.shouldDisappear) \r\n\t\t\tc.fillStyle = gamma.meteor2;\r\n\t\tc.beginPath();\r\n\t\tc.arc(this.x,this.y,this.r,0,2*Math.PI);\r\n    c.fill();\r\n    this.craters.forEach(crater => {\r\n      c.beginPath();\r\n      c.arc(this.x + crater.x, this.y + crater.y, crater.r, 0, 2 * Math.PI);\r\n      c.stroke();\r\n    })\r\n\t}\r\n\r\n\tsetMode(mode){\r\n\t\tsuper.setMode(mode);\r\n\t\tif (mode == 'flyAway'){\r\n\t\t\tthis.shouldDisappear = true;\r\n\t\t}\r\n\t}\r\n}","export class Star{\r\n\tconstructor(x, y){\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.r = Math.random() * 4;\r\n\t\tthis.backCount = 0;\r\n\t}\r\n\r\n\tdraw(context){\r\n\t\tlet radius = this.r;\r\n\t\tif (this.backCount > 0){\r\n\t\t\tradius *= this.backCount / 100;\r\n\t\t\tthis.backCount--;\r\n\t\t}\r\n\t\tcontext.fillStyle = '#fff';\r\n\t\tcontext.beginPath();\r\n\t\tcontext.arc(this.x,this.y,radius,0,2*Math.PI);\r\n\t\tcontext.fill();\r\n\t}\r\n\r\n\tflicker(){\r\n\t\tif(Math.random()<0.001){\r\n\t\t\tthis.backCount = 200;\r\n\t\t}\r\n\t}\r\n}","import { Spaceship } from './spaceship.js';\r\n\r\nexport class SpaceshipAI extends Spaceship {\r\n  constructor(options){\r\n    super(options);\r\n    const {mode, dataAI} = options;\r\n    this.applyAICalculations = (mode ? optionsAI[mode] : optionsAI['follow']).bind(this);\r\n    this.dataAI = dataAI;\r\n  }\r\n\r\n  move(){\r\n    this.applyAICalculations();\r\n    Spaceship.prototype.move.call(this);\r\n  }\r\n\r\n  setAIMode(mode, dataAI){\r\n    this.applyAICalculations = optionsAI[mode].bind(this);\r\n    this.dataAI = dataAI;\r\n  }\r\n}\r\n\r\nconst optionsAI = {\r\n\r\n  'still' : function (){\r\n\r\n  },\r\n\r\n  'follow' :  function(){\r\n    this.setDestination(this.dataAI.target.x, this.dataAI.target.y)\r\n  },\r\n\r\n  'dodge' : function(){\r\n    const threat = this.dataAI.threat;\r\n    const a = threat.dy / threat.dx;\r\n    let b = threat.y - threat.x * a;\r\n    const sinAlpha = threat.dx / Math.sqrt(threat.dx**2 + threat.dy**2);\r\n    const db = (threat.r + this.r) / sinAlpha;\r\n    if ((this.y < a * this.x + b + db) && (this.y > a * this.x + b - db)){\r\n      console.log('under threat')\r\n      const c = this.y + this.x / a;\r\n      b += this.y < a * this.x + b ? -db : db;\r\n      const x = (c - b) * a / (a**2 + 1);\r\n      const y = a * x + b;\r\n      this.setDestination(x, y);\r\n    }\r\n  }\r\n}","export class Menu {\r\n  constructor() {\r\n    this.menu = document.querySelector('menu');\r\n    this.buttons = this.menu.querySelectorAll('button');\r\n    this.buttonListeners = Array.prototype.map.call(this.buttons, el => null);\r\n    this.hide = this.hide.bind(this);\r\n    this.show = this.show.bind(this);\r\n  }\r\n\r\n  hide() {\r\n    this.menu.classList.add('hidden');\r\n  }\r\n\r\n  show() {\r\n    this.menu.classList.remove('hidden');\r\n  }\r\n\r\n  bindAction(index, action, toHide=true) {\r\n    this.buttonListeners[index] = action;\r\n    this.buttons[index].addEventListener('click', action);\r\n    this.buttons[index].classList.remove('menu__button_inactive');\r\n    if( toHide ) {\r\n      this.buttons[index].addEventListener('click', this.hide);\r\n    }\r\n  }\r\n\r\n  unbindAction(index) {\r\n    this.buttons[index].removeEventListener('click', this.buttonListeners[index]);\r\n    this.buttons[index].removeEventListener('click', this.hide);\r\n    this.buttons[index].classList.add('menu__button_inactive');\r\n    this.buttonListeners[index] = null;\r\n  }\r\n}","import {Spaceship} from './js/classes/spaceship.js';\r\nimport {Comet} from './js/classes/comet.js';\r\nimport {gamma} from './js/gamma.js';\r\nimport {Star} from './js/classes/Star.js';\r\nimport {SpaceshipAI} from './js/classes/spaceshipAI.js';\r\nimport {Menu} from './js/menu/menu.js';\r\n\r\nlet canvas = document.querySelector('canvas');\r\ncanvas.width  = window.innerWidth;\r\ncanvas.height = window.innerHeight;\r\nlet c = canvas.getContext(\"2d\");\r\n\r\n//declare functions\r\nclass Game{\r\n\tconstructor(context){\r\n\t\tthis.initialState = {\r\n\t\t\tspaceship : {\r\n\t\t\t\tx : 500,\r\n\t\t\t\ty : 300,\r\n\t\t\t\tcoordBox : {min : {x : 0, y : 0}, max : {x : canvas.width, y : canvas.height}}\r\n\t\t\t}\r\n\t\t\t/* new SpaceshipAI({x : 50, y : 50, coordBox : coordBox, speed : 5, skin : gamma.enemy, dataAI : {target : this.spaceship}}),\r\n\t\t\tnew SpaceshipAI({x : 50, y : 500, coordBox : coordBox,speed : 5, skin : gamma.enemy, dataAI : {target : this.spaceship}}) */\r\n\t\t}\r\n\t\t//init object state\r\n\t\tthis.paused = true;\r\n\t\tthis.over = false;\r\n\t\tthis.score = 0;\r\n\t\tthis.context = context;\r\n\t\t//init game objects\r\n\t\tthis.spaceship = new Spaceship({\r\n\t\t\tx : this.initialState.spaceship.x,\r\n\t\t\ty : this.initialState.spaceship.y,\r\n\t\t\tcoordBox : this.initialState.spaceship.coordBox\r\n\t\t});\r\n\t\tthis.comets = [];\r\n\t\tthis.disposableComets = [];\r\n\t\tthis.bullets = [];\r\n\t\tthis.enemySpaceships = [];\r\n\t\t//init player controls\r\n\t\tthis.eventListeners = [\r\n\t\t\t{\r\n\t\t\t\ttarget: canvas,\r\n\t\t\t\tevent: 'click',\r\n\t\t\t\thandler: (event) => {\r\n\t\t\t\t\tconst bullet = this.spaceship.shoot();\r\n\t\t\t\t\tthis.bullets.push(bullet);\r\n\t\t\t\t\tthis.enemySpaceships.forEach(ship => {\r\n\t\t\t\t\t\tship.setAIMode('dodge', {threat : bullet})\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}, {\r\n\t\t\t\ttarget: canvas,\r\n\t\t\t\tevent: 'mousemove',\r\n\t\t\t\thandler: (function(e){\r\n\t\t\t\t\treturn this.setDestination(e.x, e.y)\r\n\t\t\t\t}.bind(this.spaceship))\r\n\t\t\t}, {\r\n\t\t\t\ttarget: document,\r\n\t\t\t\tevent: 'keydown',\r\n\t\t\t\thandler: e => {\r\n\t\t\t\t\tif (e.code === \"Space\"){\r\n\t\t\t\t\t\tthis.spaceship.halt();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, {\r\n\t\t\t\ttarget: document,\r\n\t\t\t\tevent: 'keyup',\r\n\t\t\t\thandler: e => {\r\n\t\t\t\t\tif (e.code === \"Space\"){\r\n\t\t\t\t\t\tthis.spaceship.continueMovement();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\t\tthis.eventListeners.forEach( listener => {\r\n\t\t\tlistener.target.addEventListener(listener.event, listener.handler);\r\n\t\t})\r\n\t\t\r\n\t\t//init stars\r\n\t\tthis.starCount = 20;\r\n\t\tthis.stars = [];\r\n\t\tfor(let i = 0; i < this.starCount; i++){\r\n\t\t\tthis.stars.push(new Star(Math.random() * canvas.width, Math.random() * canvas.height));\r\n\t\t}\r\n\t\t//bind own functions\r\n\t\tthis.run = this.run.bind(this);\r\n\t\tthis.pause = this.pause.bind(this);\r\n\t\tthis.continue = this.continue.bind(this);\r\n\t\tthis.reset = this.reset.bind(this);\r\n\t}\r\n\r\n\tdraw(){\r\n\t\tthis.drawBackground();\r\n\t\tthis.comets.forEach(comet => comet.draw(this.context));\r\n\t\tthis.disposableComets.forEach(comet => comet.draw(this.context));\r\n\t\tthis.enemySpaceships.forEach(ship => ship.draw(this.context));\r\n\t\tthis.bullets.forEach(bullet => bullet.draw(this.context));\r\n\t\tthis.spaceship.draw(this.context);\r\n\t\t//display score\r\n\t\tc.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\tc.fillStyle = '#fff';\r\n\t\tc.font = '30px Georgia';\r\n\t\tc.fillText(this.score, canvas.width - 80, 50);\r\n\t}\r\n\r\n\tupdate(){\r\n\t\t//change background\r\n\t\tif (Math.random() < 0.01){\r\n\t\t\tthis.stars.shift();\r\n\t\t\tthis.stars.push(new Star(Math.random() * canvas.width, Math.random() * canvas.height))\r\n\t\t}\r\n\t\tthis.stars.forEach(star => star.flicker());\r\n\t\t//stop non-background updates after gameover\r\n\t\tif (this.over){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//move objects\r\n\t\tthis.comets.forEach(comet => comet.move());\r\n\t\tthis.disposableComets.forEach((comet, index, array) => {\r\n\t\t\tcomet.move();\r\n\t\t\tif (comet.gone){\r\n\t\t\t\tarray.splice(index, 1);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.enemySpaceships.forEach(ship => ship.move());\r\n\t\tthis.spaceship.move();\r\n\t\tthis.bullets.forEach((bullet, index, array) => {\r\n\t\t\tbullet.move();\r\n\t\t\tif (bullet.gone){\r\n\t\t\t\tarray.splice(index, 1);\r\n\t\t\t}\r\n\t\t});\r\n\t\t//change Enemy destination\r\n\t\tthis.enemySpaceships.forEach(ship => {\r\n\t\t\tif(Math.random() < 0.01){\r\n\t\t\t\tship.setDestination(Math.random() * canvas.width, Math.random() * canvas.height);\r\n\t\t\t}\r\n\t\t})\r\n\t\t//add new comet\r\n\t\tif(Math.random() < 0.03){\r\n\t\t\tthis.comets.push(new Comet(\r\n\t\t\t\t{\r\n\t\t\t\t\tx : 40, \r\n\t\t\t\t\ty : canvas.height/2, \r\n\t\t\t\t\tdx : (Math.random()*8 + 1) * (Math.random() < 0.5 ? 1 : -1), \r\n\t\t\t\t\tdy : (Math.random()*8 + 1) * (Math.random() < 0.5 ? 1 : -1),\r\n\t\t\t\t\tr : Math.random()*30 + 10,\r\n\t\t\t\t\tcoordBox : {min : {x : 0, y : 0}, max : {x : canvas.width, y : canvas.height}},\r\n\t\t\t\t\tmode : 'bounce'\r\n\t\t\t\t}));\r\n\t\t\tif(this.comets.length > 10){\r\n\t\t\t\tlet tempComet = this.comets.shift();\r\n\t\t\t\ttempComet.setMode('flyAway');\r\n\t\t\t\tthis.disposableComets.push(tempComet);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//check collisions between comets and bullets/spaceship\r\n\t\tthis.checkCollisions();\r\n\t\t//update score\r\n\t\tif (! this.over){\r\n\t\t\tthis.score += 1;\r\n\t\t}\r\n\t}\r\n\r\n\tcheckCollisions(){\r\n\t\t//helper function\r\n\t\tconst checkBallsIntercept = (ball1, ball2) => (Math.sqrt((ball1.x - ball2.x)**2 + (ball1.y - ball2.y)**2) < ball1.r + ball2.r);\r\n\r\n\t\tthis.comets.forEach((comet, cometIndex, cometArray) => {\r\n\t\t\t//check commet-bullet collision\r\n\t\t\tthis.bullets.forEach((bullet, bulletIndex, bulletArray)=>{\r\n\t\t\t\tif (checkBallsIntercept(comet, bullet)){\r\n\t\t\t\t\tcometArray.splice(cometIndex, 1);\r\n\t\t\t\t\tbulletArray.splice(bulletIndex, 1);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// check commet-spaceship collision\r\n\t\t\tif (checkBallsIntercept(comet, this.spaceship)){\r\n\t\t\t\t/* this.over = true;\r\n\t\t\t\tthis.spaceship.dispose(); */\r\n\t\t\t\tthis.end();\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tdrawBackground(){\r\n\t\tc.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\tc.fillStyle = gamma.space;\r\n\t\tc.fillRect(0,0,canvas.width, canvas.height);\r\n\t\tthis.stars.forEach(star => star.draw(c));\r\n\t}\r\n\r\n\trun(timestamp) {\r\n\t\t//recalculate state\r\n\t\tthis.update();\r\n\t\t//draw objects\r\n\t\tthis.draw();\r\n\t\t//nextStep\r\n\t\tif( ! this.paused) {\r\n\t\t\trequestAnimationFrame(this.run);\r\n\t\t}\r\n\t}\r\n\r\n\tpause() {\r\n\t\tthis.paused = true;\r\n\t}\r\n\r\n\tcontinue(mousePosition) {\r\n\t\tif (this.over) return;\r\n\t\tthis.paused = false;\r\n\t\tthis.spaceship.setDestination(mousePosition.x, mousePosition.y);\r\n\t\trequestAnimationFrame(this.run);\r\n\t}\r\n\r\n\tend() {\r\n\t\tthis.over = true;\r\n\t\tthis.paused = true;\r\n\t\tthis.onGameOver();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.paused = true;\r\n\t\tthis.over = false;\r\n\t\tthis.score = 0;\r\n\t\tthis.spaceship.x = this.initialState.spaceship.x;\r\n\t\tthis.spaceship.y = this.initialState.spaceship.y;\r\n\t\tthis.spaceship.setDestination(this.spaceship.x + 1, this.spaceship.y);\r\n\t\tthis.comets = [];\r\n\t\tthis.disposableComets = [];\r\n\t\tthis.bullets = [];\r\n\t\tthis.enemySpaceships = [];\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\n//set state\r\nlet game = new Game(c);\r\ngame.draw();\r\ngame.onGameOver = () => {\r\n\tmenu.show();\r\n\tmenu.unbindAction(1);\r\n}\r\n//animate\r\nlet menu = new Menu();\r\nmenu.bindAction(0, (e) => {\r\n\tgame.reset();\r\n\tgame.continue(e);\r\n\tmenu.bindAction(1, (e) => game.continue(e));\r\n});\r\ndocument.addEventListener('keydown', (e)=> {\r\n\tif( e.key === 'Escape') {\r\n\t\tmenu.show();\r\n\t\tgame.pause();\r\n\t}\r\n})\r\n//game.run();"]}